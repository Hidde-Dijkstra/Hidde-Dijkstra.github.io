
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Diagram drawing &#8212; hidde-dijkstra.github.io</title>
    
  <link rel="stylesheet" href="../../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Supercell" href="supercell.html" />
    <link rel="prev" title="Code" href="../intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
  
  <img src="../../../_static/logo.svg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">hidde-dijkstra.github.io</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../intro.html">
   Home
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../../intro.html">
   Twisted bilayer WSe
   <span class="math notranslate nohighlight">
    \(_2\)
   </span>
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="../../lattice/intro.html">
     Supercell WSe
     <span class="math notranslate nohighlight">
      \(_2\)
     </span>
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../lattice/monolayer.html">
       Monolayer WSe
       <span class="math notranslate nohighlight">
        \(_2\)
       </span>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../lattice/supercell.html">
       Supercell
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../wannierization/intro.html">
     Wannierization
    </a>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../wannierization/theory.html">
       Wannierization
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../wannierization/graphene.html">
       Graphene
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../wannierization/wse2.html">
       WSe
       <span class="math notranslate nohighlight">
        \(_2\)
       </span>
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active">
    <a class="reference internal" href="../intro.html">
     Code
    </a>
    <ul class="current">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Diagram drawing
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="supercell.html">
       Supercell
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="bandstructure.html">
       Bandstructure plotting
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="dft.html">
       Numerics
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../zbibliography.html">
     Bibliography
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/master-thesis/code/moire/diagram_gen.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/master-thesis/code/moire/diagram_gen.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#drawsvg">
   drawSvg
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#utility-functions">
   Utility functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rotation-matrix">
     Rotation matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#arrow">
     Arrow
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#index">
     Index
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#latticeatom">
   LatticeAtom
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lattice">
   Lattice
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lattice3d">
   Lattice3d
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orbital">
   Orbital
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="diagram-drawing">
<h1>Diagram drawing<a class="headerlink" href="#diagram-drawing" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">drawSvg</span> <span class="k">as</span> <span class="nn">draw</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="drawsvg">
<h2>drawSvg<a class="headerlink" href="#drawsvg" title="Permalink to this headline">¶</a></h2>
<p>The diagrams we use are based around the python module drawSvg which allows construction of svg diagrams straight from python. The main container for an image is always generated in the chapter file which is then filled with svg element groups which can pass on any arguments to its child elements (such as circles, lines etc.).</p>
</div>
<div class="section" id="utility-functions">
<h2>Utility functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rotation-matrix">
<h3>Rotation matrix<a class="headerlink" href="#rotation-matrix" title="Permalink to this headline">¶</a></h3>
<p>A function which returns a rotation matrix in the xy plane in two or three dimensions.</p>
<p>:::<a href="#id1"><span class="problematic" id="id2">:dropdown:`{python}rot_mat(θ, dim=2)`</span></a></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{python}θ</span></code> rotation angle.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}dim</span></code> dimension of desired matrix, either 2 or 3.
:::</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rot_mat</span><span class="p">(</span><span class="n">θ</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">dim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">θ</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">θ</span><span class="p">)],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">θ</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">θ</span><span class="p">)]])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">θ</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">θ</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">θ</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">θ</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="arrow">
<h3>Arrow<a class="headerlink" href="#arrow" title="Permalink to this headline">¶</a></h3>
<p>Draws an arrow between two points.</p>
<p>:::<a href="#id3"><span class="problematic" id="id4">:dropdown:`{python}arrow(start, end, stroke_width=0.1, stroke='black', **kwargs)`</span></a></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{python}start</span></code> starting point of the arrow.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}end</span></code> end point of the arrow with arrowhead.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}stroke_width</span></code> width of the arrow line.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}stroke</span></code> color of the arrow.
:::</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">arrow</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">start</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">end</span><span class="p">)</span>
    <span class="n">Δx</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">my_arrow</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">Δx</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">Δx</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">my_arrow</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">draw</span><span class="o">.</span><span class="n">Lines</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">Δx</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">Δx</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">Δx</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">stroke</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">stroke</span><span class="o">=</span><span class="n">stroke</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="n">stroke_width</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
              <span class="n">marker_end</span><span class="o">=</span><span class="n">my_arrow</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">stroke_width</span><span class="o">*</span><span class="n">Δx</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="o">*</span><span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="n">end</span><span class="o">-</span><span class="n">start</span><span class="p">)</span><span class="o">+</span><span class="n">start</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="index">
<h3>Index<a class="headerlink" href="#index" title="Permalink to this headline">¶</a></h3>
<p>Object which functions as the index of an atomic site. We overload the multiplication operator to allow for shorthand of <span class="math notranslate nohighlight">\(ia_1+ja_2\)</span>.</p>
<ul class="simple">
<li><p>:::<a href="#id5"><span class="problematic" id="id6">:dropdown:`{python}__init__(self, i, j)`</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}i</span></code> first index.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}i</span></code> second index.
:::</p></li>
</ul>
</li>
<li><p>:::<a href="#id7"><span class="problematic" id="id8">:dropdown:`{python}__mul__(self, other):`</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}other</span></code> a pair of two objects which we want to add with some integer weight, usually [<span class="math notranslate nohighlight">\(a_1\)</span>, <span class="math notranslate nohighlight">\(a_2\)</span>].
:::</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Index</span><span class="p">:</span>
 

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">=</span> <span class="n">i</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span>
        
    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span> <span class="o">*</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">*</span> <span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">*</span> <span class="n">other</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="latticeatom">
<h2>LatticeAtom<a class="headerlink" href="#latticeatom" title="Permalink to this headline">¶</a></h2>
<p>We introduce a class which keeps track of the properties of individual atoms in the unit cell with methods:</p>
<ul class="simple">
<li><p>:::<a href="#id9"><span class="problematic" id="id10">:dropdown:`{python}__init__(self, position_in_unit_cell, name=None, atom_color='blue', atom_radius=None)`</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}position_in_unit_cell</span></code> the location of the atom in the unit cell.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}name</span></code> letter e.g. C for carbon indicating the type of atom, if None no name included.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}atom_color</span></code> color to draw atom in.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}atom_radius</span></code> size of atom to plot, if None no bonds are plotted.
:::</p></li>
</ul>
</li>
<li><p>:::<a href="#id11"><span class="problematic" id="id12">:dropdown:`{python}draw_bonds(self, displacement, θ, **kwargs)`</span></a>
draws atomic bonds around the atom.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}displacement</span></code> translation with which to draw the bonds, usually a multiple of the lattice vectors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}θ</span></code> angle with which the lattice is rotated.
:::</p></li>
</ul>
</li>
<li><p>:::<a href="#id13"><span class="problematic" id="id14">:dropdown:`{python}draw_atom(self, displacement, θ, **kwargs)`</span></a>
draws the atom.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}displacement</span></code> translation with which to draw the atom, usually a multiple of the lattice vectors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}θ</span></code> angle with which the lattice is rotated.
:::</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LatticeAtom</span><span class="p">:</span>
    
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position_in_unit_cell</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">atom_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">atom_radius</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>       
        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">position_in_unit_cell</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_color</span> <span class="o">=</span> <span class="n">atom_color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_radius</span> <span class="o">=</span> <span class="n">atom_radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bond_style</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#</span>
    
    <span class="k">def</span> <span class="nf">draw_bonds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">displacement</span><span class="p">,</span> <span class="n">θ</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="n">rot_mat</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">displacement</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span><span class="p">:</span>
            <span class="n">destination</span> <span class="o">=</span> <span class="n">rot_mat</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">displacement</span><span class="o">+</span><span class="n">bond</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">draw</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span> <span class="o">*</span><span class="n">destination</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">group</span>
    
    <span class="k">def</span> <span class="nf">draw_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">displacement</span><span class="p">,</span> <span class="n">θ</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="n">rot_mat</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">displacement</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
        <span class="n">gradient</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">RadialGradient</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_radius</span><span class="p">)</span>
        <span class="n">gradient</span><span class="o">.</span><span class="n">addStop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">gradient</span><span class="o">.</span><span class="n">addStop</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_color</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">draw</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_radius</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">gradient</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">draw</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_radius</span><span class="p">,</span> <span class="o">*</span><span class="n">origin</span><span class="p">,</span> <span class="n">text_anchor</span><span class="o">=</span><span class="s1">&#39;middle&#39;</span><span class="p">,</span> <span class="n">alignment_baseline</span><span class="o">=</span><span class="s2">&quot;central&quot;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">group</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="lattice">
<h2>Lattice<a class="headerlink" href="#lattice" title="Permalink to this headline">¶</a></h2>
<p>We introduce a class which collects all LatticeAtom objects in the unit cell and expands the lattice to fit into a diagram of size <span class="math notranslate nohighlight">\(W\times H\)</span>.</p>
<ul class="simple">
<li><p>:::<a href="#id15"><span class="problematic" id="id16">:dropdown:`{python}__init__(self, a_1, a_2, W, H, θ=0)`</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}a_1</span></code> first lattice vector of 2d lattice.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}a_2</span></code> second lattice vector of 2d lattice.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}W</span></code> desired width of diagram.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}H</span></code> desired height of diagram.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}θ</span></code> rotation angle of lattice.
:::</p></li>
</ul>
</li>
<li><p>:::<a href="#id17"><span class="problematic" id="id18">:dropdown:`{python}add_atom(self, atom)`</span></a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}atom</span></code> LatticeAtom object to be added to the unit cell.
:::</p></li>
</ul>
</li>
<li><p>:::<a href="#id19"><span class="problematic" id="id20">:dropdown:`{python}in_lattice(self, i, j, atom)`</span></a>
checks if the position of <code class="docutils literal notranslate"><span class="pre">{python}atom</span></code> plus <span class="math notranslate nohighlight">\(ia_1+ja_2\)</span> lies within desired frame of the diagram.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}i</span></code> first index.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}j</span></code> second index.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}atom</span></code> <code class="docutils literal notranslate"><span class="pre">{python}LatticeAtom</span></code> object to be tested.
:::</p></li>
</ul>
</li>
<li><p>:::<a href="#id21"><span class="problematic" id="id22">:dropdown:`{python}NN(self, atom_1, atom_2, bond_list, **kwargs)`</span></a>
designate two <code class="docutils literal notranslate"><span class="pre">{python}LatticeAtom</span></code> objects as nearest neighbors</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}atom_1</span></code> first <code class="docutils literal notranslate"><span class="pre">{python}LatticeAtom</span></code> object.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}atom_2</span></code> second <code class="docutils literal notranslate"><span class="pre">{python}LatticeAtom</span></code> object.
:::</p></li>
</ul>
</li>
<li><p>:::<a href="#id23"><span class="problematic" id="id24">:dropdown:`draw_lattice(self)`</span></a>
returns svg group with all atoms and bonds in diagram frame.
:::</p></li>
<li><p>:::<a href="#id25"><span class="problematic" id="id26">:dropdown:`draw_lattice_vectors(self, vec_symbols=['a₁', 'a₂'], origin=(0, 0), centralize=True, stroke_width=0.1, color='black', **kwargs)`</span></a>
returns svg group containing the two lattice vectors.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}vec_symbols</span></code> list of two labels for the lattice vectors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}origin</span></code> coordinate from where to draw the lattice vectors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}centralize</span></code> if <code class="docutils literal notranslate"><span class="pre">{python}True</span></code> translate the origin by <span class="math notranslate nohighlight">\((a_1+a_2)/2\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}vec_symbols</span></code> list of two labels for the lattice vectors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}vec_symbols</span></code> list of two labels for the lattice vectors.
:::</p></li>
</ul>
</li>
<li><p>:::<a href="#id27"><span class="problematic" id="id28">:dropdown:`{python}draw_unit_cell(self, origin=(0, 0), **kwargs)`</span></a>
returns svg group containing dashed lines showing the unit cells.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}origin</span></code> coordinate from where to start the unit cell.
:::</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Lattice</span><span class="p">:</span>
    
    <span class="n">unit_cell_NN</span> <span class="o">=</span> <span class="p">[</span><span class="n">Index</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a_1</span><span class="p">,</span> <span class="n">a_2</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">θ</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a_1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a_2</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a_1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">W</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">H</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">θ</span> <span class="o">=</span> <span class="o">-</span><span class="n">θ</span>
        
    <span class="k">def</span> <span class="nf">add_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom</span><span class="p">):</span>        
        <span class="n">N_1</span><span class="p">,</span> <span class="n">N_2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="nb">min</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mf">0.00001</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.00001</span><span class="p">)))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="n">rot_mat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">θ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span><span class="nd">@a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">atom_radius</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">atom_radius</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">])</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">N_1</span><span class="p">,</span> <span class="n">N_2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">5</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Index</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">N_1</span><span class="p">,</span> <span class="n">N_1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">N_2</span><span class="p">,</span> <span class="n">N_2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_lattice</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">atom</span><span class="p">)])</span>
        
    <span class="k">def</span> <span class="nf">in_lattice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">atom</span><span class="p">):</span>
        <span class="n">origin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">rot_mat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">θ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span> <span class="o">@</span> <span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">position</span><span class="o">+</span><span class="n">Index</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">origin</span><span class="o">-</span><span class="n">atom</span><span class="o">.</span><span class="n">atom_radius</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
        
    <span class="k">def</span> <span class="nf">NN</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom_1</span><span class="p">,</span> <span class="n">atom_2</span><span class="p">,</span> <span class="n">bond_list</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#atom_1.bond_style.append(kwargs)</span>
        <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">bond_list</span><span class="p">:</span>
            <span class="n">atom_1</span><span class="o">.</span><span class="n">bonds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom_2</span><span class="o">.</span><span class="n">position</span><span class="o">+</span><span class="n">Index</span><span class="p">(</span><span class="o">*</span><span class="n">bond</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">atom_1</span> <span class="o">!=</span> <span class="n">atom_2</span><span class="p">:</span>
                <span class="c1">#atom_2.bond_style.append(kwargs)</span>
                <span class="c1">#atom_2.bonds.append(-atom_1.bonds[-1])</span>
                <span class="k">pass</span>
                
    <span class="k">def</span> <span class="nf">draw_lattice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">grid_point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">draw_bonds</span><span class="p">(</span><span class="n">grid_point</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">θ</span><span class="p">),</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>                
                <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">draw_atom</span><span class="p">(</span><span class="n">grid_point</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">θ</span><span class="p">),</span> <span class="n">z</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">group</span>
               
    <span class="k">def</span> <span class="nf">draw_lattice_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vec_symbols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a₁&#39;</span><span class="p">,</span> <span class="s1">&#39;a₂&#39;</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">centralize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">rot</span> <span class="o">=</span> <span class="n">rot_mat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">θ</span><span class="p">)</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">centralize</span><span class="p">:</span>
            <span class="n">origin</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrow</span><span class="p">(</span><span class="n">rot</span><span class="nd">@origin</span><span class="p">,</span> <span class="n">rot</span><span class="o">@</span><span class="p">(</span><span class="n">origin</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">stroke_width</span><span class="o">=</span><span class="n">stroke_width</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arrow</span><span class="p">(</span><span class="n">rot</span><span class="nd">@origin</span><span class="p">,</span> <span class="n">rot</span><span class="o">@</span><span class="p">(</span><span class="n">origin</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">stroke_width</span><span class="o">=</span><span class="n">stroke_width</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">draw</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">vec_symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stroke_width</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">rot</span><span class="o">@</span><span class="p">(</span><span class="n">origin</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">))</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">draw</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">vec_symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">stroke_width</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">rot</span><span class="o">@</span><span class="p">(</span><span class="n">origin</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">group</span>
    
    <span class="k">def</span> <span class="nf">draw_unit_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">rot</span> <span class="o">=</span> <span class="n">rot_mat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">θ</span><span class="p">)</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">Group</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">]))</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">H</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">draw</span><span class="o">.</span><span class="n">Line</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">rot</span><span class="o">@</span><span class="p">(</span><span class="n">origin</span><span class="o">-</span><span class="n">vector</span><span class="o">+</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])),</span> <span class="o">*</span><span class="p">(</span><span class="n">rot</span><span class="o">@</span><span class="p">(</span><span class="n">origin</span><span class="o">+</span><span class="n">vector</span><span class="o">+</span><span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">group</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="lattice3d">
<h2>Lattice3d<a class="headerlink" href="#lattice3d" title="Permalink to this headline">¶</a></h2>
<p>A child class of <code class="docutils literal notranslate"><span class="pre">{python}Lattice</span></code> which supports 3d plotting to generate a plotly lattice.</p>
<ul class="simple">
<li><p>:::<a href="#id29"><span class="problematic" id="id30">:dropdown:`{python}gen_NN(self, R)`</span></a>
generates a list of nearest neighbors for each atom in the unit cell within some radius <span class="math notranslate nohighlight">\(R\)</span>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}R</span></code> radius within which an atom is considered a nearest neighbor.
:::</p></li>
</ul>
</li>
<li><p>:::<a href="#id31"><span class="problematic" id="id32">:dropdown:`{python}draw_3d(self, fig, origin=(0, 0, 0))`</span></a>
adds a lattice to a plotly figure.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}fig</span></code> 3d plotly figure to which we wish to add a lattice.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}origin</span></code> origin of the lattice.
:::</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Lattice3d</span><span class="p">(</span><span class="n">Lattice</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">gen_NN</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_NN</span><span class="p">:</span>
                    <span class="n">ΔR</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">index</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">position</span>
                    <span class="k">if</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">6</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">ΔR</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">R</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">bonds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">index</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">bonds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">index</span><span class="p">)</span>
            
    <span class="k">def</span> <span class="nf">draw_3d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_cell</span><span class="p">):</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">atom_color</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="n">index</span><span class="o">+</span><span class="n">atom</span><span class="o">.</span><span class="n">position</span><span class="o">+</span><span class="n">origin</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
            <span class="k">for</span> <span class="n">bond</span> <span class="ow">in</span> <span class="n">atom</span><span class="o">.</span><span class="n">bonds</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                    <span class="n">x_2</span><span class="p">,</span> <span class="n">y_2</span><span class="p">,</span> <span class="n">z_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">bond</span><span class="o">+</span><span class="n">origin</span>
                    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">x_2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">y_2</span><span class="p">],</span> <span class="n">z</span><span class="o">=</span><span class="p">[</span><span class="n">z</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">z_2</span><span class="p">],</span> 
                                           <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">),</span> <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                              <span class="n">name</span><span class="o">=</span><span class="n">atom</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;markers&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="orbital">
<h2>Orbital<a class="headerlink" href="#orbital" title="Permalink to this headline">¶</a></h2>
<p>A class to draw orbital diagrams.</p>
<ul class="simple">
<li><p>:::<a href="#id33"><span class="problematic" id="id34">:dropdown:`{python}lobe(self, color, rotate=0, translate=(0, 0), stroke=&quot;black&quot;, **kwargs)`</span></a>
a base lobe with which to construct more complex orbitals.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}color</span></code> color of the lobe.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}rotate</span></code> angle with which to rotate the lobe.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}translate</span></code> vector with which to translate the lobe.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}stroke</span></code> color of the border of lobe.
:::</p></li>
</ul>
</li>
<li><p>:::<a href="#id35"><span class="problematic" id="id36">:dropdown:`{python}circle(self, color, rotate=0, translate=(0, 0), stroke=&quot;black&quot;, ellipse=False, **kwargs)`</span></a>
a base circle with which to construct more complex orbitals.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}color</span></code> color of the circle.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}rotate</span></code> angle with which to rotate the circle.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}translate</span></code> vector with which to translate the circle.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}stroke</span></code> color of the border of circle.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}ellipse</span></code> if * <code class="docutils literal notranslate"><span class="pre">{python}True</span></code> the circle is deformed to an ellipse.
:::</p></li>
</ul>
</li>
<li><p>:::{dropdown}<code class="docutils literal notranslate"><span class="pre">{python}d_xy(self,</span> <span class="pre">translate=(0,</span> <span class="pre">0),</span> <span class="pre">rotate=0,</span> <span class="pre">neg_color=&quot;dodgerblue&quot;,</span> <span class="pre">pos_color=&quot;red&quot;,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">**kwargs)</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}translate</span></code> vector with which to translate the orbital.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}rotate</span></code> angle with which to rotate the orbital.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}neg_color</span></code> color of the negative parts of the orbital.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}pos_color</span></code> color of the positive parts of the orbital.
:::</p></li>
</ul>
</li>
<li><p>:::{dropdown}<code class="docutils literal notranslate"><span class="pre">{python}d_z2(self,</span> <span class="pre">translate=(0,</span> <span class="pre">0),</span> <span class="pre">rotate=0,</span> <span class="pre">neg_color=&quot;dodgerblue&quot;,</span> <span class="pre">pos_color=&quot;red&quot;,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">**kwargs)</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}translate</span></code> vector with which to translate the orbital.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}rotate</span></code> angle with which to rotate the orbital.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}neg_color</span></code> color of the negative parts of the orbital.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}pos_color</span></code> color of the positive parts of the orbital.
:::</p></li>
</ul>
</li>
<li><p>:::{dropdown}<code class="docutils literal notranslate"><span class="pre">{python}d_x2y2(self,</span> <span class="pre">translate=(0,</span> <span class="pre">0),</span> <span class="pre">rotate=0,</span> <span class="pre">neg_color=&quot;dodgerblue&quot;,</span> <span class="pre">pos_color=&quot;red&quot;,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">**kwargs)</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}translate</span></code> vector with which to translate the orbital.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}rotate</span></code> angle with which to rotate the orbital.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}neg_color</span></code> color of the negative parts of the orbital.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{python}pos_color</span></code> color of the positive parts of the orbital.
:::</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Orbital</span><span class="p">:</span>  
    
    
    <span class="k">def</span> <span class="nf">lobe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">stroke</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">gradient</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">RadialGradient</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">gradient</span><span class="o">.</span><span class="n">addStop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
        <span class="n">gradient</span><span class="o">.</span><span class="n">addStop</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">color</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;translate(&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">translate</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">rotate(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rotate</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; 0 0)&quot;</span>
        <span class="n">my_path</span> <span class="o">=</span> <span class="s2">&quot;M 0,0 C &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;,-2 &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span><span class="s2">&quot;,-2 0,0 z&quot;</span>
        <span class="k">return</span> <span class="n">draw</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">my_path</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="n">stroke</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">gradient</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">circle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">stroke</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">ellipse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">gradient</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">RadialGradient</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">gradient</span><span class="o">.</span><span class="n">addStop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
        <span class="n">gradient</span><span class="o">.</span><span class="n">addStop</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">color</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="s2">&quot;rotate(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rotate</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; 0 0)</span><span class="se">\n</span><span class="s2">translate(&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">translate</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
        <span class="k">if</span> <span class="n">ellipse</span><span class="p">:</span>
            <span class="n">clip</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">ClipPath</span><span class="p">()</span>
            <span class="n">clip</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">draw</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">draw</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="n">stroke</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">gradient</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">draw</span><span class="o">.</span><span class="n">Circle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">stroke</span><span class="o">=</span><span class="n">stroke</span><span class="p">,</span> <span class="n">stroke_width</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">gradient</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">d_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">neg_color</span><span class="o">=</span><span class="s2">&quot;dodgerblue&quot;</span><span class="p">,</span> <span class="n">pos_color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">Group</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe</span><span class="p">(</span><span class="n">neg_color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">85</span><span class="o">+</span><span class="n">rotate</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">))</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe</span><span class="p">(</span><span class="n">pos_color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">95</span><span class="o">+</span><span class="n">rotate</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">))</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe</span><span class="p">(</span><span class="n">pos_color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">275</span><span class="o">+</span><span class="n">rotate</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">))</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe</span><span class="p">(</span><span class="n">neg_color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">265</span><span class="o">+</span><span class="n">rotate</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">group</span>
    
    <span class="k">def</span> <span class="nf">d_z2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">neg_color</span><span class="o">=</span><span class="s2">&quot;dodgerblue&quot;</span><span class="p">,</span> <span class="n">pos_color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">Group</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe</span><span class="p">(</span><span class="n">neg_color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">180</span><span class="o">+</span><span class="n">rotate</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">))</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">pos_color</span><span class="p">,</span> <span class="n">ellipse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="n">rotate</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">))</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe</span><span class="p">(</span><span class="n">neg_color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="n">rotate</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">group</span>
    
    <span class="k">def</span> <span class="nf">d_x2y2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">neg_color</span><span class="o">=</span><span class="s2">&quot;dodgerblue&quot;</span><span class="p">,</span> <span class="n">pos_color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
               <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">draw</span><span class="o">.</span><span class="n">Group</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe</span><span class="p">(</span><span class="n">neg_color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">180</span><span class="o">+</span><span class="n">rotate</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">))</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe</span><span class="p">(</span><span class="n">neg_color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="n">rotate</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">))</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe</span><span class="p">(</span><span class="n">pos_color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">90</span><span class="o">+</span><span class="n">rotate</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">))</span>
        <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lobe</span><span class="p">(</span><span class="n">pos_color</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">270</span><span class="o">+</span><span class="n">rotate</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">translate</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">group</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./master-thesis/code/moire"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../intro.html" title="previous page">Code</a>
    <a class='right-next' id="next-link" href="supercell.html" title="next page">Supercell</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Hidde Dijkstra<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>